{% extends "layout.html" %} {% block title %}
<title>Tasks</title>
{% endblock title %} {% block mainheader %}
<!-- TASKS SECTION -->
<section class="tasks">
  <!-- tasks header -->
  <div class="tasks-header">
    <div class="title-search">
      <div class="tasks-title">
        <h2>My Tasks</h2>
        <p>Create and manage your tasks</p>
      </div>
      <div class="search-bar">
        <h3>Find a Task</h3>
        <i class="fa-solid fa-magnifying-glass"></i>
      </div>
    </div>

    <div class="profile-pic">
      <i class="fa-solid fa-comments"></i>
      <i class="fa-solid fa-bell"></i>
      <img src="{{ image_file }}" alt="profile picture" />
      <h4>Hello {{ current_user.username }}</h4>
    </div>
  </div>
  <!-- TASKS BODY -->
  <div class="tasks-body">
    <!-- Top row -->
    <div class="tasks-top">
      <!-- pending -->
      <div class="pending"></div>
      <!-- calendar -->
      <div class="calendar"></div>
      <!-- priority & overdue -->
      <div class="priority-overdue">
        <div class="overdue"></div>
        <div class="priority">
          <h2>Priority</h2>
          <div class="color-code">
            <!-- high color code -->
            <div class="code">
              <h5>High</h5>
              <div class="purple1"></div>
            </div>
            <!-- medium color code -->
            <div class="code">
              <h5>Mid</h5>
              <div class="purple2"></div>
            </div>
            <!-- low color code -->
            <div class="code">
              <h5>Low</h5>
              <div class="purple3"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Bottom row -->
    <div class="tasks-bottom">
      <!-- Create task button -->
      <div class="create-task">
        <button onclick="openForm()">Create a Task +</button>
      </div>
      <!-- tasks list -->
      <div class="tasks-list">
        <!-- tasks columns -->
        {% for task in my_tasks %}
        <div class="one-task">
          <!-- title & update button -->
          <div class="title-update">
            <div class="task-title-{{ task.priority }}">{{ task.title }}</div>
            <div class="task-update">
              <a href="{{ url_for('update_task', task_id=task.id) }}">
                <button onclick="updateForm()">UPDATE</button>
              </a>
              
            </div>
          </div>
          <!-- progress bar -->
          <div class="progress-bar">
            <!-- <h5>Progress {{ task.progress }}</h5> -->
          </div>
          <!-- desc, due & completed -->
          <div class="desc-due-comp">
            <div class="table-head">
              <h2>Todo</h2>
              <h2>Due</h2>
            </div>
            <div class="smallest">
              <p class="todd">{{ task.todo }}</p>
              <h4 class="dodd">{{ task.date_due }}</h4>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
  <!-- Trigger button for the pop-up -->
  <!-- <button onclick="openForm()">Open Form</button> -->
  <!-- The pop-up form container -->
  <div class="overlay" id="overlay">
    <div class="form-container">
      <span class="close-btn" onclick="closeForm()">&times;</span>
      <form method="POST" action="" class="create-form">
        {{ form.hidden_tag() }}
        <fieldset>
          <legend>CREATE TASK</legend>
          <div class="bigger">{{ form.title(class="new-1") }}</div>
          <div class="bigger">
            {{ form.priority(class="new-2", id="prior") }}
          </div>
          <div class="bigger-1">
            {{ form.content(class="new") }} {{ form.date_due(class="new-3") }}
            {% if form.date_due.errors %} {% for error in form.date_due.errors
            %} <span class="danger"> {{ error }} </span><br />
            {% endfor %} {% endif %}
          </div>
        </fieldset>
        <div class="add-button">{{ form.submit(class="add") }}</div>
      </form>
    </div>
  </div>
  <script>
    // Function to open the pop-up form
    function openForm() {
      document.getElementById("overlay").style.display = "flex";
    }

    // Function to close the pop-up form
    function closeForm() {
      document.getElementById("overlay").style.display = "none";
    }

    // Event listener to trigger the pop-up form
    document.getElementById("openFormBtn").addEventListener("click", openForm);
  </script>
  <script>
    // Function to open the pop-up form
    function updateForm() {
      document.getElementById("overlay-2").style.display = "flex";
    }

    // Function to close the pop-up form
    function closeForm2() {
      document.getElementById("overlay-2").style.display = "none";
    }

    // Event listener to trigger the pop-up form
    document.getElementById("updateFormBtn").addEventListener("click", updateForm);
  </script>
</section>
{% endblock mainheader %}
